# ANS OME Scripts

This repository contains scripts used in the conversion to Omero pipeline. The `conversion.py` script is a Python script used to stitch .tif tile images into full stitched .ome.tiff images that are compatible with the Omero image viewer web application.

## Image Stitching and Conversion

The `conversion.py` script was developed in Python 3.9.18

### Installation

Install [Python](https://www.python.org/downloads/) (make sure the version is compatible with the script)

You can create a virtual environment or use the default environment in Python to install the dependencies needed to run the script. I recommend using a virtual environment to keep all of the dependencies and scripts in the same, contained environment for the project.

You can install all of the dependencies (modules) required to run the script into your Python environment using the following command (the `requirements.txt` file is provided in this repository):

`pip3 install -r requirements.txt`

Navigate into the directory with the script and ensure that the current Python environment you are in has the necessary dependencies to run the script. Run the script using the following command:

`python3 conversion.py -h`

The help flag `-h` will provide you with more information on how to run the script with the required and optional arguments depending on your conversion needs.

## Setting Up Omero

### Method 1: Docker
Install [Docker](https://docs.docker.com/engine/install/) onto the server that will be running the Omero instance. This server will be responsible for managing the Omero server, web services, and database. Ensure that the server is secure before running Docker and creating the Omero instance. 

Configure Docker to your liking but ensure that the Docker commands can only be executed by users with sudo privileges.

It is recommended to have a user with sudo privileges manage the Docker containers and Omero instance.

The easiest way to get an Omero instance up and running is through using docker compose, which allows you to start an multi-container application quickly. The Omero web application requires three Docker containers to run (Omero server, Omero web, and PostgreSQL database). Install the docker compose files from this [GitHub repository](https://github.com/ome/docker-example-omero). You can clone the repository or just install the ZIP file directory. 

After installing the repository files into a directory, run the following commands using the user with sudo privileges to start the Omero instance.

Change directory into the directory that contains the docker-compose.yml file (you just downloaded this directory):

`cd <directory-with-docker-compose-yml-file>`,

Pull the latest major versions of the containers:

`sudo docker compose pull`

Start the containers:

`sudo docker compose up -d`

The following command is optional as it is only really needed if you want to see the outputs generated by the containers:

`sudo docker compose logs -f`

To stop the docker container, ensure that you are in the same directory containing the docker-compose.yml file and run the following command:

`sudo docker compose down`

Note: Any changes you make within these Docker containers (configs, files, or directorys) will get deleted after the containers shut down. To save the changes you make within a container, commit the container with the changes as a new image and run the container using the new image in the future. 

Images imported to Omero or changes made within the Omero web application will get saved when the containers shut down as long as you do not delete the Docker volumes associated with the Omero application.

#### Mount Volumes


#### Getting into the container

If you want to make changes to the environment of a Docker container (make new folders, add new configurations, or change the Omero web UI), you can do so using the following command: 

`sudo docker exec -it <container_name_or_id> /bin/bash`

This command lets you go inside the Docker container environment and run commands within the environment to make changes.



### Method 2: Direct Installation






### OMERO PYTHON

